<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dyslexia Reader | NeuroAid</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"/>
  <style>
    @font-face {
      font-family: 'OpenDyslexic';
      src: url('/static/fonts/OpenDyslexic-Regular.woff2') format('woff2'),
           url('/static/fonts/OpenDyslexic-Regular.woff') format('woff'),
           url('/static/fonts/OpenDyslexic-Regular.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }
    body, p, h1, h2, h3, h4, h5, h6, textarea, input, button, select {
      font-family: 'OpenDyslexic', Arial, sans-serif !important;
    }
    .ruler { position:absolute; height:2.2em; background:rgba(99,102,241,0.15); border-radius:6px; display:none }
    .card {
      background: #fff;
      border-radius: 1.25rem;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
      padding: 1.8rem;
    }
    #reader.opendyslexic-font { font-family: 'OpenDyslexic', Arial, sans-serif !important; }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- Navbar -->
  <header class="bg-white shadow">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
      <h1 class="text-2xl font-bold text-indigo-600">NeuroAid</h1>
      <nav class="space-x-6 font-medium">
        <a href="/" class="hover:text-indigo-500">Home</a>
        <a href="/dyslexia" class="hover:text-indigo-500 text-indigo-600">Dyslexia</a>
        <a href="/games" class="hover:text-indigo-500">Games</a>
        <a href="/dashboard" class="hover:text-indigo-500">Dashboard</a>
        <a href="/about" class="hover:text-indigo-500">About</a>
      </nav>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-6 py-14 space-y-14">
    
    <!-- Intro -->
    <section class="card text-center">
      <h2 class="text-3xl font-bold text-indigo-700 mb-4">Understanding Dyslexia</h2>
      <p class="text-lg text-gray-700 leading-relaxed">
        Dyslexia is a learning disability that primarily affects a person's ability to read and process written language, despite having normal intelligence and motivation to learn. While it can manifest in different ways, it is generally characterized by difficulties with phonological processing, decoding, and reading fluency. With the right support and tools, individuals with dyslexia can thrive academically and professionally.
      </p>
    </section>

    <!-- Accordion -->
    <section class="card space-y-4">
      <h3 class="text-2xl font-bold text-indigo-700 mb-2">Types & Symptoms</h3>
      <details class="bg-gray-50 rounded-lg p-4">
        <summary class="cursor-pointer font-semibold">üìñ Types of Dyslexia</summary>
        <ul class="list-disc list-inside mt-2 text-gray-700">
          <li><b>Phonological Dyslexia:</b> Difficulty breaking down words into sounds.</li>
          <li><b>Rapid Naming Dyslexia:</b> Difficulty naming familiar objects quickly.</li>
          <li><b>Double Deficit Dyslexia:</b> A combination of phonological and rapid naming difficulties.</li>
          <li><b>Surface Dyslexia:</b> Struggles recognizing whole words by sight.</li>
          <li><b>Visual Dyslexia:</b> Difficulties remembering what was seen on a page.</li>
        </ul>
      </details>
      <details class="bg-gray-50 rounded-lg p-4">
        <summary class="cursor-pointer font-semibold">‚ö†Ô∏è Symptoms of Dyslexia</summary>
        <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
          <li><b>Preschool:</b> Delayed speech, trouble rhyming, struggles learning letters/numbers.</li>
          <li><b>School Age:</b> Reading below grade level, decoding issues, poor spelling, avoiding reading.</li>
          <li><b>Teens/Adults:</b> Slow reading/writing, spelling errors, difficulty proofreading and comprehension.</li>
        </ul>
      </details>
    </section>

    <!-- Reader Tools -->
    <section class="card space-y-6">
      <h3 class="text-2xl font-bold text-indigo-700">Dyslexia-Friendly Reader</h3>

      <!-- Controls -->
      <div class="grid md:grid-cols-3 gap-6">
        <label class="flex flex-col text-sm font-medium">
          Font size
          <input id="fontSize" type="range" min="14" max="28" value="18" class="mt-2">
        </label>
        <label class="flex flex-col text-sm font-medium">
          Line height
          <input id="lineHeight" type="range" min="1.2" max="2.2" step="0.1" value="1.6" class="mt-2">
        </label>
        <label class="flex flex-col text-sm font-medium">
          Voice rate
          <input id="rate" type="range" min="0.6" max="1.6" step="0.1" value="1.0" class="mt-2">
        </label>
      </div>

      <div class="flex flex-wrap items-center gap-4">
        <label class="flex items-center gap-2">
          <input type="checkbox" id="rulerToggle" class="h-4 w-4"> Reading ruler
        </label>
        <button id="savePrefs" class="ml-auto px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
          üíæ Save Preferences
        </button>
      </div>

      <!-- Voice -->
      <div class="flex flex-wrap items-center gap-4">
        <select id="voiceSelect" class="border px-3 py-2 rounded flex-1 min-w-[200px]"></select>
        <button id="speakBtn" class="px-5 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">üîä Read Aloud</button>
        <button id="stopSpeakBtn" class="px-5 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">‚èπ Stop</button>
      </div>

      <!-- Reader -->
      <div class="reading-area relative opendyslexic-font mt-8" id="reader" tabindex="0">
        <div class="ruler" id="ruler"></div>
        <textarea id="text-input" rows="6" class="w-full border rounded p-3" placeholder="Paste or type text here‚Ä¶"></textarea>

        <div class="grid md:grid-cols-2 gap-8 mt-6">
          <div class="original border p-4 rounded">
            <h4 class="font-semibold mb-2">Original</h4>
            <div id="original-text" class="min-h-[80px]"></div>
          </div>
          <div class="scrambled border p-4 rounded bg-gray-50">
            <h4 class="font-semibold mb-2">Scrambled View</h4>
            <div id="scrambled-text" class="min-h-[80px]"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Diagnostic Tool -->
    <section class="card space-y-6">
      <h3 class="text-2xl font-bold text-indigo-700">Dyslexia Self-Check</h3>
      <p class="text-gray-700">This quick screening is <b>not a diagnosis</b>, but can highlight potential signs of dyslexia. Please consult a specialist for professional assessment.</p>

      <form id="diagnostic-form" class="space-y-4">
        <div>
          <label class="flex items-center space-x-2">
            <input type="checkbox" name="q1"> <span>I often mix up similar-looking letters (b/d, p/q, m/n).</span>
          </label>
        </div>
        <div>
          <label class="flex items-center space-x-2">
            <input type="checkbox" name="q2"> <span>I have difficulty spelling even familiar words correctly.</span>
          </label>
        </div>
        <div>
          <label class="flex items-center space-x-2">
            <input type="checkbox" name="q3"> <span>I read slower than my peers or colleagues.</span>
          </label>
        </div>
        <div>
          <label class="flex items-center space-x-2">
            <input type="checkbox" name="q4"> <span>I avoid reading aloud whenever possible.</span>
          </label>
        </div>
        <div>
          <label class="flex items-center space-x-2">
            <input type="checkbox" name="q5"> <span>I have trouble remembering sequences (days, months, directions).</span>
          </label>
        </div>
        <button type="button" id="diagnostic-submit" class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">Check Result</button>
      </form>

      <div id="diagnostic-result" class="mt-4 text-lg font-semibold text-center"></div>
    </section>

    <div class="text-center">
      <a href="/" class="inline-block px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg shadow hover:bg-indigo-700">
        ‚Üê Back to Home
      </a>
    </div>
  </main>

  <footer class="bg-gray-100 py-6 mt-12 text-center text-gray-600">
    <p>&copy; 2025 NeuroAid. All rights reserved.</p>
  </footer>

  <!-- Scripts -->
  <script>
    // Elements
    const textInput = document.getElementById("text-input");
    const originalText = document.getElementById("original-text");
    const scrambledText = document.getElementById("scrambled-text");
    const reader = document.getElementById("reader");
    const fontSize = document.getElementById("fontSize");
    const lineHeight = document.getElementById("lineHeight");
    const rulerToggle = document.getElementById("rulerToggle");
    const savePrefs = document.getElementById("savePrefs");
    const ruler = document.getElementById("ruler");

    // Ruler
    reader.addEventListener("mousemove", (e) => {
      if (rulerToggle.checked) {
        ruler.style.display = "block";
        ruler.style.top = `${e.clientY - reader.getBoundingClientRect().top - 20}px`;
        ruler.style.width = "100%";
      } else {
        ruler.style.display = "none";
      }
    });

    // Apply Styles
    function applyStyles() {
      reader.style.fontSize = `${fontSize.value}px`;
      reader.style.lineHeight = lineHeight.value;
    }
    fontSize.addEventListener("input", applyStyles);
    lineHeight.addEventListener("input", applyStyles);

    // Save Prefs
    savePrefs.addEventListener("click", () => {
      const prefs = {
        fontSize: fontSize.value,
        lineHeight: lineHeight.value,
        ruler: rulerToggle.checked,
      };
      localStorage.setItem("dyslexiaPrefs", JSON.stringify(prefs));
      alert("Preferences saved!");
    });

    // Load Prefs
    window.addEventListener("load", () => {
      const prefs = JSON.parse(localStorage.getItem("dyslexiaPrefs"));
      if (prefs) {
        fontSize.value = prefs.fontSize;
        lineHeight.value = prefs.lineHeight;
        rulerToggle.checked = prefs.ruler;
        applyStyles();
      }
    });

    // Scramble
    function scrambleWord(word) {
      if (word.length <= 3) return word;
      const middle = word.slice(1, -1).split("");
      for (let i = middle.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [middle[i], middle[j]] = [middle[j], middle[i]];
      }
      return word[0] + middle.join("") + word[word.length - 1];
    }

    let originalWords = [];
    let scrambleInterval;

    textInput.addEventListener("input", () => {
      const text = textInput.value;
      originalText.textContent = text;
      originalWords = text.split(/\s+/);
      if (scrambleInterval) clearInterval(scrambleInterval);
      scrambleInterval = setInterval(() => {
        scrambledText.textContent = originalWords.map(scrambleWord).join(" ");
      }, 800);
    });

    // Text-to-Speech
    const speakBtn = document.getElementById("speakBtn");
    const stopSpeakBtn = document.getElementById("stopSpeakBtn");
    const rate = document.getElementById("rate");
    const voiceSelect = document.getElementById("voiceSelect");
    let synth = window.speechSynthesis;
    let utter;

    function populateVoices() {
      const voices = synth.getVoices();
      voiceSelect.innerHTML = "";
      voices.forEach((voice, i) => {
        const option = document.createElement("option");
        option.value = i;
        option.textContent = `${voice.name} (${voice.lang})`;
        voiceSelect.appendChild(option);
      });
    }
    populateVoices();
    if (speechSynthesis.onvoiceschanged !== undefined) {
      speechSynthesis.onvoiceschanged = populateVoices;
    }

    speakBtn.addEventListener("click", () => {
      if (synth.speaking) synth.cancel();
      utter = new SpeechSynthesisUtterance(textInput.value);
      utter.rate = parseFloat(rate.value);
      const selectedVoice = synth.getVoices()[voiceSelect.value];
      if (selectedVoice) utter.voice = selectedVoice;
      synth.speak(utter);
    });

    stopSpeakBtn.addEventListener("click", () => synth.cancel());

    // Diagnostic Tool
    const diagnosticForm = document.getElementById("diagnostic-form");
    const diagnosticResult = document.getElementById("diagnostic-result");
    document.getElementById("diagnostic-submit").addEventListener("click", () => {
      const checks = diagnosticForm.querySelectorAll("input[type='checkbox']:checked");
      const score = checks.length;
      if (score <= 1) {
        diagnosticResult.textContent = "‚úÖ Low signs of dyslexia. Likely typical reading pattern.";
        diagnosticResult.className = "mt-4 text-green-600 font-bold text-center";
      } else if (score <= 3) {
        diagnosticResult.textContent = "‚ö†Ô∏è Moderate signs. You may benefit from extra support with reading.";
        diagnosticResult.className = "mt-4 text-yellow-600 font-bold text-center";
      } else {
        diagnosticResult.textContent = "‚ùó High signs of dyslexia. Consider seeking a professional evaluation.";
        diagnosticResult.className = "mt-4 text-red-600 font-bold text-center";
      }
    });
  </script>
</body>
</html>
